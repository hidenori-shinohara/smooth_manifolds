\subsection{Exercises}
\begin{customexer}{3.5(Proof of Lemma 3.4)}
  Suppose $M$ is a smooth manifold with or without boundary, $p \in M, v \in T_pM$, and $f, g \in C^{\infty}(M)$.
  \begin{enumerate}[label=(\alph*)]
    \item 
      If $f$ is a constant function, then $vf = 0$.
    \item
      If $f(p) = g(p) = 0$, then $v(fg) = 0$.
  \end{enumerate}
\end{customexer}

\begin{proof}
  $ $
  \begin{enumerate}[label=(\alph*)]
    \item
      Let $h$ be the constant function that always takes the value 1.
      Then $f(p) = ch(p)$ for some $c \in \mathbb{R}$.
      Then $v(ff) = f(p)vf + f(p)vf$, so $c^2v(h) = c^2v(h) + c^2v(h)$.
      Therefore, $c^2v(h) = 0$, so $cv(h) = 0$.
      Since $v$ is linear, this implies $0 = v(ch) = v(f)$, so $v(f) = 0$.
    \item
      $v(fg) = f(p)vg + g(p)vf = 0 + 0 = 0$.
  \end{enumerate}
\end{proof}

\begin{customexer}{3.7(Proof of Proposition 3.6)}
  Let $M, N$, and $P$ be smooth manifolds with or without boundary, let $F: M \rightarrow N$ and $G: N \rightarrow P$ be smooth maps, and let $p \in M$.
  \begin{enumerate}[label=(\alph*)]
    \item
      $dF_p:T_pM \rightarrow T_{F(p)}N$ is linear.
    \item
      $d(G \circ F)_p = dG_{F(p)} \circ dF_p: T_pM \rightarrow T_{G \circ F(p)} P$.
    \item
      $d(\Id_M)_p = \Id_{T_pM}: T_pM \rightarrow T_pM$.
    \item
      If $F$ is a diffeomorphism, then $dF_p: T_pM \rightarrow T_{F(p)}N$ is an isomorphism, and $(dF_p)^{-1} = d(F^{-1})_{F(p)}$.
  \end{enumerate}
\end{customexer}

\begin{proof}
  \begin{enumerate}[label=(\alph*)]
    \item
      $\forall v, w \in T_pM, \forall c \in \mathbb{R}, \forall f \in C^{\infty}(N)$,
      \begin{align*}
        dF_p(cv + w)(f)
          &= (cv + w)(f \circ F) \\
          &= (cv)(f \circ F) + w(f \circ F) \\
          &= c(v(f \circ F)) + w(f \circ F) \\
          &= c(dF_p(v)(f)) + dF_p(w)(f) \\
          &= (cdF_p(v))(f) + dF_p(w)(f) \\
          &= (cdF_p(v) + dF_p(w))(f).
      \end{align*}
      Therefore, $dF_p(cv + w) = cdF_p(v) + dF_p(w)$.
    \item
      $\forall v \in T_pM, f \in C^{\infty}(P)$,
      \begin{align*}
        d(G \circ F)_p(v)(f)
          &= v(f \circ (G \circ F)) \\
          &= v((f \circ G) \circ F) \\
          &= (dF_p(v))(f \circ G) \\
          &= (dG_{F(p)}(dF_p(v)))(f) \\
          &= ((dG_{F(p)} \circ dF_p)(v))(f) \\
      \end{align*}
      Therefore, $d(G \circ F)_p = dG_{F(p)} \circ dF_p$.
    \item
      $\forall v \in T_p(M), \forall f \in C^{\infty}(M)$,
      \begin{align*}
        d(\Id_M)_p(v)(f)
          &= v(f \circ \Id_M) \\
          &= v(f).
      \end{align*}
      Therefore, $d(\Id_M)_p(v) = v$, so $d(\Id_M)_p = \Id_{T_pM}$.
    \item
      $F^{-1}$ exists and it is a smooth map since $F$ is a diffeomorphism.
      By combining (b) and (c), we obtain $dF_p$ and $dF^{-1}_{F(p)}$ are the inverse of each other.
      Therefore, $dF_p$ is an isomorphism.
  \end{enumerate}
\end{proof}

\subsection{Problems}

\begin{customprob}{3-1}
  Suppose $M$ and $N$ are smooth manifolds with or without boundary, and $F: M \rightarrow N$ is a smooth map.
  Show that $dF_p: T_pM \rightarrow T_{F(p)}N$ is the zero map for each $p \in M$ if and only if $F$ is constant on each component of $M$.
\end{customprob}

\begin{proof}
  Suppose $dF_p: T_pM \rightarrow T_{F(p)}N$ is the zero map for each $p \in M$.
  It suffices to show that for every $p \in M$, there exists a neighborhood of $p$ on which $F$ is constant.
  Let $p \in M$ and $(U, \phi) \in \mathcal{A}_M, (V, \psi) \i \mathcal{A}_N$ be given such that $p \in U$ and $F(U) \subset V$.
  Without loss of generality, we assume $\hat{U} = \phi(U)$ is an open ball in $\mathbb{R}^m$.
  Then for any $i, j$ and for any $q \in \hat{U}$,
  \begin{align*}
    dF_q(\frac{\partial}{\partial x^i}\vert_q)(\pi_j \circ \psi) = 0
      &\implies (\frac{\partial}{\partial x^i}\vert_q)(\pi_j \circ \psi \circ F) = 0 \\
      &\implies (\frac{\partial}{\partial x^i}\vert_{\phi(q)})(\pi_j \circ \psi \circ F \circ \phi^{-1}) = 0.
  \end{align*}
  Fix $j$.
  Then every partial derivative of $\pi_j \circ \psi \circ F \circ \phi^{-1}$ at every point in $\hat{U}$ is 0.
  The intermediate value theorem implies that $\pi_j \circ \psi \circ F \circ \phi^{-1}$ is constant on $\hat{U}$ because $\hat{U}$ is an open ball.
  In other words, $(\pi_j \circ \psi \circ F \circ \phi^{-1})(\hat{U}) = \{ y_j \}$ for some $y_j \in \mathbb{R}$.
  Since this is true for every $j$ and $\pi_j$ is the projection of the $j$th coordinate, $(\psi \circ F \circ \phi^{-1})(\hat{U}) = \{ y \}$ where $y = (y_1, \cdots, y_n)$.
  Then $(F \circ \phi^{-1})(\hat{U}) = F(U) = \psi^{-1}(y)$.
  Since $\psi$ is a homeomorphism, there exists exactly one point in $\psi^{-1}(U)$.
  In other words, $F$ is constant on $U$.
  Therefore, $F$ is constant on each path component.

  Suppose $F$ is constant on each component of $M$.
  Let $p \in M$.
  Choose a chart $(U, \phi) \in \mathcal{A}_M$ such that $p \in U$.
  Then $F \circ \phi^{-1}$ is constant in a neighborhood around $\phi(p)$.
  For any $i$,
  \begin{align*}
    dF_p(\frac{\partial}{\partial x^i}\vert_p)(f)
      &= \frac{\partial}{\partial x^i}\vert_p(f \circ F) \\
      &= \frac{\partial}{\partial x^i}\vert_{\phi(p)}(f \circ F \circ \phi^{-1}) \\
      &= 0
  \end{align*}
  because $f \circ F \circ \phi^{-1}$ is constant in a neighborhood around $\phi(p)$.
  By Proposition 3.15, $\partial / \partial x^i\vert_p$ form a basis for $T_pM$.
  Since $dF_p$ sends each basis element to 0, $dF_p = 0$.
\end{proof}

\begin{customprob}{3-2(Proof of Proposition 3.14)}\label{problem_3_2}
  Let $M_1, \cdots, M_k$ be smooth manifolds, and for each $j$, let $\pi_j: M_1 \times \cdots \times M_k \rightarrow M_j$ be the projection onto the $M_j$ factor.
  For any point $p = (p_1, \cdots, p_k) \in M_1 \times \cdots \times M_k$, the map
  \begin{align*}
    \alpha: T_p(M_1 \times \cdots \times M_k) \rightarrow T_{p_1}M_1 \oplus \cdots \oplus T_{p_k}M_k
  \end{align*}
  defined by
  \begin{align*}
    \alpha(v) = (d(\pi_1)_p(v), \cdots, d(\pi_k)_p(v))
  \end{align*}
  is an isomorphism.
  The same is true if one of the spaces $M_i$ is a smooth manifold with boundary.
\end{customprob}

\begin{proof}
  It suffices to show this for the case that $k = 2$ because the results extend to arbitrary $k$ by induction.
  Let $\mathcal{A}_{M_1}, \mathcal{A}_{M_2}, \mathcal{A}_{M_1 \times M_2}$ be the smooth structures of $M_1, M_2, M_1 \times M_2$.

  We first define a lot of notations.
  \begin{itemize}
    \item
      Let $d_1, d_2$ denote the dimensions of $M_1, M_2$ and let $d = d_1 + d_2$ denote the dimension of $M_1 \times M_2$.
    \item
      Let $p = (p_1, p_2) \in M_1 \times M_2$ be given.
      Choose $(U, \phi = (x^i)) \in \mathcal{A}_{M_1}, (V, \psi = (y^i)) \in \mathcal{A}_{M_2}$ with $p_1 \in U$ and $p_2 \in V$.
      Let $q_1 = \phi(p_1), q_2 = \psi(p_2), q = q_1 \times q_2$.
    \item
      $(U \times V, (z^i)) \in \mathcal{A}_{M_1 \times M_2}$ and $(p_1, p_2) \in U \times V$ where $(z^i) = \phi \times \psi$.
      More specifically, $z^i = x^i \circ \pi_1$ for $1 \leq i \leq d_1$ and $z^i = y^i \circ \pi_2$ for $d_1 + 1 \leq i \leq d_1 + d_2$.
  \end{itemize}
  Note that we use $x^i, y^i, z^i, \pi_1$ to mean two different things in this solution: 
  \begin{itemize}
    \item
      $x^i$ is either the $i$th coordinate function of $\phi$ or the $i$th projection map $\mathbb{R}^{d_1} \rightarrow \mathbb{R}$.
    \item
      $y^i$ is either the $i$th coordinate function of $\psi$ or the $i$th projection map $\mathbb{R}^{d_2} \rightarrow \mathbb{R}$.
    \item
      $z^i$ is either the $i$th coordinate function of $\phi \times \psi$ or the $i$th projection map $\mathbb{R}^{d_1 + d_2} \rightarrow \mathbb{R}$.
    \item
      $\pi_1$ is either the projection map $M_1 \times M_2 \rightarrow M_1$ or the projection map $\mathbb{R}^{d_1 + d_2} \rightarrow \mathbb{R}^{d_1}$.
    \item
      $\pi_2$ is either the projection map $M_1 \times M_2 \rightarrow M_2$ or the projection map $\mathbb{R}^{d_1 + d_2} \rightarrow \mathbb{R}^{d_2}$.
  \end{itemize}

  By Proposition 3.15, $\{ \partial / \partial x^1 \vert_{p_1}, \cdots, \partial / \partial x^{d_1} \vert_{p_1} \}, \{ \partial / \partial y^1 \vert_{p_2}, \cdots, \partial / \partial y^{d_2} \vert_{p_2} \}, \{ \partial / \partial z^1 \vert_{p}, \cdots, \partial / \partial z^{d_1 + d_2} \vert_{p} \}$ form bases for $T_{p_1}M_1, T_{p_2}M_2, T_p(M_1 \times M_2)$.

  $\alpha(\partial / \partial z^1 \vert_p) = (d(\pi_1)_p(\partial/\partial z^1\vert_p), d(\pi_2)_p(\partial/\partial z^1\vert_p))$.
  We claim that $d(\pi_1)_p(\partial / \partial z^1 \vert_p) = \partial / \partial x^1 \vert p_1$.

  \begin{align*}
    d(\pi_1)_p(\partial / \partial z^1 \vert_p)(f)
      &= d(\pi_1)_p(d(\phi^{-1} \times \psi^{-1})_q)(\frac{\partial}{\partial z^1}\vert_q) (f)\\
      &= (d(\pi_1)_p \circ d(\phi^{-1} \times \psi^{-1})_q)(\frac{\partial}{\partial z^1}\vert_q) (f)\\
      &= d(\pi_1 \circ (\phi^{-1} \times \psi^{-1})_q)(\frac{\partial}{\partial z^1}\vert_q) (f)\\
      &= \lim_{h \rightarrow 0} \frac{(f \circ \pi_1 \circ (\phi^{-1} \times \psi^{-1}))(q + e_1h) - (f \circ \pi_1 \circ (\phi^{-1} \times \psi^{-1}))(q)}{h} \\
      &= \lim_{h \rightarrow 0} \frac{(f \circ \pi_1)(\phi^{-1}(q_1 + e_1h), p_2) - (f \circ \pi_1)(p)}{h} \\
      &= \lim_{h \rightarrow 0} \frac{f(\phi^{-1}(q_1 + e_1h)) - f(p_1)}{h} \\
      &= \lim_{h \rightarrow 0} \frac{f(\phi^{-1}(q_1 + e_1h)) - f(\phi^{-1}(q_1))}{h} \\
      &= (\frac{\partial}{\partial x^1}\vert_{q_1})(f \circ \phi^{-1}) \\
      &= d(\phi^{-1})_{q_1}(\frac{\partial}{\partial x^1}\vert_{q_1})(f) \\
      &= (\frac{\partial}{\partial x^1}\vert_{p_1})(f).
  \end{align*}

  The same result can be shown for the other combinations of $\pi_1, \pi_2$ and $z^1, \cdots, z^{d_1 + d_2}$.
  For any $c_1, \cdots, c_{d_1 + d_2} \in \mathbb{R}$,
  \begin{align*}
    \alpha(\sum_{i=1}^{d_1 + d_2} c_{i}\frac{\partial}{\partial z^{i}}\vert_p)
      &= \sum_{i=1}^{d_1 + d_2} c_i\alpha(\frac{\partial}{\partial z^{i}}\vert_p) \\
      &= \sum_{i=1}^{d_1 + d_2} c_i(d(\pi_1)_p\frac{\partial}{\partial z^{i}}\vert_p, d(\pi_2)_p\frac{\partial}{\partial z^i}\vert_p) \\
      &= \sum_{i=1}^{d_1} c_i(d(\pi_1)_p\frac{\partial}{\partial z^{i}}\vert_p, d(\pi_2)_p\frac{\partial}{\partial z^i}\vert_p) 
         + \sum_{i=d_1 + 1}^{d_2} c_i(d(\pi_1)_p\frac{\partial}{\partial z^{i}}\vert_p, d(\pi_2)_p\frac{\partial}{\partial z^i}\vert_p) \\
      &= \sum_{i=1}^{d_1} c_i(\frac{\partial}{\partial x^i} \vert_{p_1}, 0)
         + \sum_{i=1}^{d_2} c_{d_1 + i}(0, \frac{\partial}{\partial y^i} \vert_{p_2}) \\
      &= (c_1\frac{\partial}{\partial x^1}\vert_{p_1} + \cdots + c_{d_1}\frac{\partial}{\partial x^{d_1}}\vert_{p_1},
          c_{d_1 + 1}\frac{\partial}{\partial y^{1}}\vert_{p_2} + \cdots + c_{d_1 + d_2}\frac{\partial}{\partial y^{d_2}}\vert_{p_2}).
  \end{align*}

  Therefore, $\alpha$ is bijective.
\end{proof}
