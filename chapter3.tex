\subsection{Exercises}
\begin{customthm}{3.2}
  Let $a \in \mathbb{R}^n$.
  \begin{enumerate}[label=(\alph*)]
    \item 
      For each geometric tangent vector $v_a \in \mathbb{R}^n_a$, the map $D_v\vert_a:C^{\infty}(\mathbb{R}^n) \rightarrow \mathbb{R}$ defined by
      \begin{align*}
        D_v\vert_a f = D_vf(a) = \frac{d}{dt}\Big\vert_{t = 0} f(a + tv)
      \end{align*}
      is a derivation at $a$.
    \item
      The map $v_a \mapsto D_v\vert_a$ is an isomorphism from $\mathbb{R}^n_a$ onto $T_a\mathbb{R}^n$.
  \end{enumerate}
\end{customthm}

\begin{proof}
  $ $
  \begin{enumerate}[label=(\alph*)]
    \item 
      $D_v\vert_a$ is linear because $D_v\vert_a(f + cg) = D_v(f + cg)(a) = D_v(f)(a) + cD_vg(a) = D_v\vert_a(f) + cD_v\vert_a(g)$ because directional derivatives are linear.
      Moreover, the product rule is satisfied because directional derivatives satisfy that.
      Therefore, $D_v\vert_a$ is a linear map that satisfies directional derivatives, so it is a derivation.
    \item
      Let $\phi: \mathbb{R}^n_a \rightarrow T_a\mathbb{R}^n$ be defined such that $v_a \mapsto D_v\vert_a$.
      We first claim that $\phi$ is linear.
      \begin{align*}
        \phi(v_a + cw_a)(f)
          &= \phi((v + cw)_a)(f) \\
          &= D_{v + cw}f(a) \\
          &= D_vf(a) + cD_wf(a) \\
          &= D_v\vert_a(f) + cD_w\vert_a(f) \\
          &= \phi(v_a)(f) + c\phi(w_a)(f) \\
          &= (\phi(v_a) + c\phi(w_a))(f).
      \end{align*}
      Next, we claim that $\ker(\phi) = 0$.
      Let $v_a \in \ker(\phi) \subset \mathbb{R}^n_a$.
      Let $v_1, \cdots, v_n \in \mathbb{R}^n$ be chosen such that $v_a = \sum_{i=1}^{n} v_ie_i\vert_a$.
      For each $j$, let $x^j: \mathbb{R}^n \rightarrow \mathbb{R}$ denote the projection map of the $j$th coordinate.
      Then $0 = D_v\vert_a(x^j) = \frac{d}{dt}\vert_{t = 0}x^j(a + tv) = v_j$ for each $j$.
      Therefore, $v_1 = \cdots = v_n = 0$, so $\ker(\phi) = 0$.
      Since $\phi$ is linear, $\phi$ must be injective.

      Lastly, we claim that $\phi$ is surjective.
      Let $w \in T_a\mathbb{R}^n$ be given.
      For each $j$, let $v_j = w(x^j)$.
      Let $v = (v_1, \cdots, v_n)$.
      We claim that $\phi(v_a) = w$.
      Let $f \in C^{\infty}(\mathbb{R}^n)$.
      By Theorem C.15, we can write
      \begin{align*}
        f(x) = f(a) + \sum_{i=1}^{n} \frac{\partial f}{\partial x^i}(a)(x^i - a^i) + \sum_{i, j = 1}^{n} (x^i - a^i)(x^j - a^j) \int_{0, 1} F(t) dt
      \end{align*}
      where $F(t)$ is some function.
      Since $(x^i - a^i)$ and $(x^j - a^j)\int_{0, 1} F(t)dt$ vanish at $x = a$, $w((x^i - a^i)(x^j - a^j) \int_{0, 1} F(t) dt) = 0$ for any $i, j$.
      Therefore, 
      \begin{align*}
        w(f)
          &= w(f(a)) + \sum_{i=1}^{n} \frac{\partial f}{\partial x^i}(a)(w(x^i) - w(a^i)) \\
          &= \sum_{i=1}^{n} \frac{\partial f}{\partial x^i}(a)w(x^i) \\
          &= \sum_{i=1}^{n} \frac{\partial f}{\partial x^i}(a)v_i \\
          &= \phi(v_a)(f)
      \end{align*}
      which proves that $\phi$ is surjective.
  \end{enumerate}
\end{proof}

\begin{customexer}{3.5(Proof of Lemma 3.4)}
  Suppose $M$ is a smooth manifold with or without boundary, $p \in M, v \in T_pM$, and $f, g \in C^{\infty}(M)$.
  \begin{enumerate}[label=(\alph*)]
    \item 
      If $f$ is a constant function, then $vf = 0$.
    \item
      If $f(p) = g(p) = 0$, then $v(fg) = 0$.
  \end{enumerate}
\end{customexer}

\begin{proof}
  This is similar to Lemma 3.1.
  \begin{enumerate}[label=(\alph*)]
    \item
      Let $h$ be the constant function that always takes the value 1.
      Then $v(h) = v(h^2) = h(p)v(h) + h(p)v(h) = 2v(h)$, so $v(h) = 0$.
      Since $f(p) = ch(p)$ for some $c \in \mathbb{R}$ and $v$ is linear, this implies $0 = cv(h) = v(ch) = v(f)$.
    \item
      $v(fg) = f(p)vg + g(p)vf = 0 + 0 = 0$.
  \end{enumerate}
\end{proof}

\begin{customexer}{3.7(Proof of Proposition 3.6)}\label{proof_prop_3_6}
  Let $M, N$, and $P$ be smooth manifolds with or without boundary, let $F: M \rightarrow N$ and $G: N \rightarrow P$ be smooth maps, and let $p \in M$.
  \begin{enumerate}[label=(\alph*)]
    \item
      $dF_p:T_pM \rightarrow T_{F(p)}N$ is linear.
    \item
      $d(G \circ F)_p = dG_{F(p)} \circ dF_p: T_pM \rightarrow T_{G \circ F(p)} P$.
    \item
      $d(\Id_M)_p = \Id_{T_pM}: T_pM \rightarrow T_pM$.
    \item
      If $F$ is a diffeomorphism, then $dF_p: T_pM \rightarrow T_{F(p)}N$ is an isomorphism, and $(dF_p)^{-1} = d(F^{-1})_{F(p)}$.
  \end{enumerate}
\end{customexer}

\begin{proof}
  \begin{enumerate}[label=(\alph*)]
    \item
      $\forall v, w \in T_pM, \forall c \in \mathbb{R}, \forall f \in C^{\infty}(N)$,
      \begin{align*}
        dF_p(cv + w)(f)
          &= (cv + w)(f \circ F) \\
          &= (cv)(f \circ F) + w(f \circ F) \\
          &= c(v(f \circ F)) + w(f \circ F) \\
          &= c(dF_p(v)(f)) + dF_p(w)(f) \\
          &= (cdF_p(v))(f) + dF_p(w)(f) \\
          &= (cdF_p(v) + dF_p(w))(f).
      \end{align*}
      Therefore, $dF_p(cv + w) = cdF_p(v) + dF_p(w)$.
    \item
      $\forall v \in T_pM, f \in C^{\infty}(P)$,
      \begin{align*}
        d(G \circ F)_p(v)(f)
          &= v(f \circ (G \circ F)) \\
          &= v((f \circ G) \circ F) \\
          &= (dF_p(v))(f \circ G) \\
          &= (dG_{F(p)}(dF_p(v)))(f) \\
          &= ((dG_{F(p)} \circ dF_p)(v))(f) \\
      \end{align*}
      Therefore, $d(G \circ F)_p = dG_{F(p)} \circ dF_p$.
    \item
      $\forall v \in T_p(M), \forall f \in C^{\infty}(M)$,
      \begin{align*}
        d(\Id_M)_p(v)(f)
          &= v(f \circ \Id_M) \\
          &= v(f).
      \end{align*}
      Therefore, $d(\Id_M)_p(v) = v$, so $d(\Id_M)_p = \Id_{T_pM}$.
    \item
      $F^{-1}$ exists and it is a smooth map since $F$ is a diffeomorphism.
      By combining (b) and (c), we obtain $dF_p$ and $dF^{-1}_{F(p)}$ are the inverse of each other.
      Therefore, $dF_p$ is an isomorphism.
  \end{enumerate}
\end{proof}

\begin{customthm}{3.10}
  If $M$ is an $n$-dimensional smooth manifold, then for each $p \in M$, the tangent space $T_pM$ is an $n$-dimensional vector space.
\end{customthm}

\begin{proof}
  Let $\mathcal{A}$ denote the smooth structure of $M$ and let $p \in M$ be given.
  Choose $(U, \phi) \in \mathcal{A}$ such that $p \in U$.
  Then
  \begin{align*}
    T_pM \overset{di_p}{\cong} T_pU \overset{d\phi_p}{\cong} T_{\phi(p)} \hat{U} \overset{di_{\phi(p)}}{\cong} T_{\phi(p)}\mathbb{R}^n
  \end{align*}
  where $di_p$ is induced by the inclusion map $i: U \rightarrow M$ and $di_{\phi(p)}$ is induced by the inclusion map $: \hat{U} \rightarrow \mathbb{R}^n$.
  $di_p, d\phi_p, di_{\phi(p)}$ are all isomorphisms by (\ref{proof_prop_3_6}(d)) and Proposition 3.9.
  Therefore, $\dim(T_pM) = n$.
\end{proof}

\begin{customthm}{3.15}
  Let $M$ be a smooth $n$-manifold with or without boundary, and let $p \in M$.
  Then $T_pM$ is an $n$-dimensional vector space, and for any smooth chart $(U, (x^i))$ containing $p$, the coordinate vectors $\partial / \partial x^1\vert_p, \cdots, \partial / \partial x^n\vert_p$ form a basis for $T_pM$.
\end{customthm}

\begin{proof}
  By Proposition 3.12, $T_pM$ is an $n$-dimensional vector space.
  By Corollary 3.3, the $\partial / \partial x^i \vert_{\phi(p)}$ form a basis for $T_{\phi(p)}\mathbb{R}^n$.
  By Proposition 3.6(d), $d\phi_p:T_pM \rightarrow T_{\phi(p)}\mathbb{R}^n$ is an isomorphism.
  Since $d\phi_p$ is an isomorphism between vector spaces, $d\phi_p$ sends a basis to a basis.
  In other words, the $\partial / \partial x^i \vert_p = (d\phi_p)^{-1}(\partial / \partial x^i \vert_{\phi(p)})$ form a basis.
\end{proof}

\begin{rem}\label{jacobian_differentials}
  The discussion on PP.61-62 shows the connection between differentials and Jacobian matrices.
  Let $F: \mathbb{R}^n \rightarrow \mathbb{R}^m$ be a smooth map and let $p \in \mathbb{R}^n$ be given.
  \begin{align}
    dF_p(\frac{\partial}{\partial x^i}\Big\vert_p)(f) 
      &= \frac{\partial}{\partial x^i}\Big\vert_p(f \circ F) & \text{(definition of $d$)} \\
      &= \frac{\partial (f \circ F)}{\partial x^i}(p) & \text{(Just a partial derivative of $f \circ F$)} \\
      &= \sum_{j=1}^{m} \frac{\partial f}{\partial y^j}(F(p))\frac{\partial F^j}{\partial x^i}(p) \\
      &= \sum_{j=1}^{m} \frac{\partial F^j}{\partial x^i}(p)\frac{\partial f}{\partial y^j}(F(p)) & \text{(Multiplication is commutative in $\mathbb{R}$)} \\
      &= \sum_{j=1}^{m} \frac{\partial F^j}{\partial x^i}(p)\frac{\partial}{\partial y^j}\Big\vert_{F(p)}(f).
  \end{align}
  Therefore, we obtain that $dF_p(\frac{\partial}{\partial x^i}\big\vert_p) = \sum_{j=1}^{m} \frac{\partial F^j}{\partial x^i}(p)\frac{\partial}{\partial y^j}\big\vert_{F(p)}$.
  $\{ \partial / \partial x^i \}$ and $\{ \partial / \partial y^j \}$ form bases for $T_p\mathbb{R}^n$ and $T_{F(p)}\mathbb{R}^m$, respectively, so it makes sense to put $dF_p$ is a matrix form.
  Then we obtain

  \begin{align*}
    \begin{bmatrix}
      \frac{\partial F^1}{\partial x^1}(p) & \cdots & \frac{\partial F^1}{\partial x^n}(p) \\
      \vdots & \ddots & \vdots \\
      \frac{\partial F^m}{\partial x^1}(p) & \cdots & \frac{\partial F^m}{\partial x^n}(p)
    \end{bmatrix}
  \end{align*}

  which is identical to the Jacobian matrix of $F$ at $p$.
  Two things to note:
  \begin{itemize}
    \item
      It makes sense to discuss the Jacobian matrix of $F$ because $F$ is a map from $\mathbb{R}^m$ to $\mathbb{R}^n$.
    \item
      The same calculation applies if $F: U \rightarrow V$ where $U, V$ are open subsets of $\mathbb{R}^n, \mathbb{R}^m$ or where $U, V$ are open subsets of $\mathbb{H}^n, \mathbb{H}^m$.
  \end{itemize}

  We now consider a more general case when $F: M \rightarrow N$ is a smooth map between two smooth manifolds with or without boundary.
  Let $p \in M$ be given.
  Let $(U, \phi), (V, \psi)$ be smooth charts of $M, N$ that contain $p, F(p)$, respectively.
  Let $\hat{F} = \psi \circ F \circ \phi^{-1}: \phi(U \cap F^{-1}(V)) \rightarrow \psi(V)$ and $\hat{p} = \phi(p)$.
  Then we obtain the following commutative diagram:

  \begin{center}
    \begin{tikzcd}[cells={nodes={minimum height=2em}}]
      U \cap F^{-1}(V) \arrow[r, "F"] \arrow[d, "\phi"]   & F \arrow[d, "\psi"] \\
      \phi(U \cap F^{-1}(V)) \arrow[r, "\hat{F}"]         & \hat{V}
    \end{tikzcd}
  \end{center}

  We compute
  \begin{align*}
    dF_p(\frac{\partial}{\partial x^i}\Big\vert_p)
      &= dF_p(d(\phi^{-1})_{\hat{p}}(\frac{\partial}{\partial x^i}\Big\vert_{\hat{p}})) & \text{(Definition of a coordinate vector)} \\
      &= (dF_p \circ d(\phi^{-1})_{\hat{p}})(\frac{\partial}{\partial x^i}\Big\vert_{\hat{p}}) \\
      &= (d(F \circ \phi^{-1})_{\hat{p}})(\frac{\partial}{\partial x^i}\Big\vert_{\hat{p}}) & (\ref{proof_prop_3_6}) \\
      &= d(\psi^{-1} \circ \hat{F})_{\hat{p}}(\frac{\partial}{\partial x^i}\Big\vert_{\hat{p}}) & \text{(See the diagram above)} \\
      &= (d(\psi^{-1})_{\hat{F}(\hat{p})} \circ d\hat{F}_{\hat{p}})(\frac{\partial}{\partial x^i}\Big\vert_{\hat{p}}) & (\ref{proof_prop_3_6}) \\
      &= d(\psi^{-1})_{\hat{F}(\hat{p})}(d\hat{F}_{\hat{p}}(\frac{\partial}{\partial x^i}\Big\vert_{\hat{p}})) \\
      &= d(\psi^{-1})_{\hat{F}(\hat{p})}(\sum_{j=1}^{m} \frac{\partial \hat{F}^j}{\partial x^i}(\hat{p})\frac{\partial}{\partial y^j}\Big\vert_{\hat{F}(\hat{p})}) & (\text{Discussion above})\\
      &= \sum_{j=1}^{m} \frac{\partial \hat{F}^j}{\partial x^i}(\hat{p}) d(\psi^{-1})_{\hat{F}(\hat{p})}(\frac{\partial}{\partial y^j}\Big\vert_{\hat{F}(\hat{p})}) & (\text{Linearity of a differential})\\
      &= \sum_{j=1}^{m} \frac{\partial \hat{F}^j}{\partial x^i}(\hat{p}) d(\psi^{-1})_{\psi(F(p))}(\frac{\partial}{\partial y^j}\Big\vert_{\psi(F(p))}) & (\text{Diagram above})\\
      &= \sum_{j=1}^{m} \frac{\partial \hat{F}^j}{\partial x^i}(\hat{p}) \frac{\partial}{\partial y^j} \Big\vert_{F(p)} & (\text{Definition of a coordinate vector}).
  \end{align*}
  Therefore, even in this general case, $dF_p$ is represented in coordinate bases by the Jacobian matrix of $\hat{F}$.
\end{rem}

\begin{rem}\label{remark_3_12}
  The notation on P.63-64 is not easy to understand.

  Let $M$ be an $n$-dimensional smooth manifold.
  Let $(U, \phi = (x^i)), (V, \psi = (\tilde{x}^i))$ be two smooth charts on $M$ and $p \in U \cap V$.
  The textbook denotes the transition map $\psi \circ \phi^{-1}: \phi(U \cap v) \rightarrow \psi(U \cap V)$ by
  \begin{align*}
    \psi \circ \phi^{-1}(x) = (\tilde{x}^1(x), \cdots, \tilde{x}^n(x)).
  \end{align*}
  What (I think) this really means is
  \begin{align*}
    (\psi \circ \phi^{-1})(x^1(p), \cdots, x^n(p)) = (\tilde{x}^1(p), \cdots, \tilde{x}^n(p))
  \end{align*}
  for each $p \in U \cap V$.
  The idea is that $\phi = (x^i)$ is a diffeomorphism, so the textbook decides to denote each point in $\phi(U \cap V)$ by $x$ because every point in $\phi(U \cap V)$ can be denoted by $(x^1(p), \cdots, x^n(p))$ for a unique $p \in U \cap V$.

  Moreover, the second part of this discussion (after ``By (3.9), the differential $d(\psi \circ \phi^{-1})_{\phi(p)}$ can be written") is even more confusing because:
  \begin{itemize}
    \item
      The textbook simply uses $x^i$ and $\tilde{x}^i$ to represent the coordinates of $\hat{U}$ and $\hat{V}$ instead of the coordinate functions of $\phi$ and $\psi$.
    \item
      $\hat{U}$ and $\hat{V}$ both live in $\mathbb{R}^n$, so it might seem unnecessary to use both $x^i$ and $\tilde{x}^i$.
      It is actually necessary because we want to use $\partial / \partial x^i$ to talk about the coordinate vectors induced by $\phi$ and $\partial / \partial \tilde{x}^i$ to talk about the coordinate vectors induced by $\psi$.
  \end{itemize}

  Finally, (3.12) in the textbook can be derived as following:
  \begin{align*}
    v &= \sum_{i=1}^{n} v^i \frac{\partial}{\partial x^i} \Big\vert_p \\
      &= \sum_{i=1}^{n} v^i (\sum_{j=1}^{n} \frac{\partial\tilde{x}^j}{\partial x^i}(\hat{p})\frac{\partial}{\partial \tilde{x}^j}\Big\vert_p) & \text{((3.11) in the textbook)}\\
      &= \sum_{i=1}^{n} (\sum_{j=1}^{n} v^i\frac{\partial\tilde{x}^j}{\partial x^i}(\hat{p})\frac{\partial}{\partial \tilde{x}^j}\Big\vert_p) \\
      &= \sum_{j=1}^{n} \big[\sum_{i=1}^{n} v^i\frac{\partial\tilde{x}^j}{\partial x^i}(\hat{p})\big]\frac{\partial}{\partial \tilde{x}^j}\Big\vert_p.
  \end{align*}
\end{rem}

\begin{customexer}{3.17}
  Let $(x, y)$ denote the standard coordinates on $\mathbb{R}^2$.
  Verify that $(\tilde{x}, \tilde{y})$ are global smooth coordinates on $\mathbb{R}^2$, where
  \begin{align*}
    \tilde{x} = x, \quad \tilde{y} = y + x^3.
  \end{align*}
  Let $p$ be the point $(1, 0) \in \mathbb{R}^2$ (in standard coordinates), and show that
  \begin{align*}
    \frac{\partial}{\partial x}\Big\vert_p \ne \frac{\partial}{\partial \tilde{x}}\Big\vert_p,
  \end{align*}
  even though the coordinate function $x$ and $\tilde{x}$ are identically equal.
\end{customexer}

\begin{proof}
  The map $(x, y) \mapsto (x, y + x^3)$ is a smooth automorphism on $\mathbb{R}^2$.
  \begin{align*}
    \frac{\partial}{\partial x}\Big\vert_p
      &= \frac{\partial \tilde{x}}{\partial x}(1, 0)\frac{\partial}{\partial \tilde{x}}\Big\vert_p + \frac{\partial \tilde{y}}{\partial x}(1, 0)\frac{\partial}{\partial \tilde{y}}\Big\vert_p & \text{((3.11) in the textbook)} \\
      &= \frac{\partial}{\partial \tilde{x}}\Big\vert_p + 3\frac{\partial}{\partial \tilde{y}}\Big\vert_p & (\frac{\partial \tilde{y}}{\partial x} = 3x^2) \\
      &\ne \frac{\partial}{\partial \tilde{x}}\Big\vert_p.
  \end{align*}
\end{proof}

\begin{customexer}{3.19}
  Suppose $M$ is a smooth manifold with boundary.
  Show that $TM$ has a natural topology and smooth structure making it into a smooth manifold with boundary, such that if $(U, (x^i))$ is any smooth boundary chart for $M$, then rearranging the coordinates in the natural chart $(\pi^{-1}(U), (x^i, v^i))$ for $TM$ yields a boundary chart $(\pi^{-1}(U), (v^i, x^i))$.
\end{customexer}

\begin{proof}
  The proof is similar to that of Proposition 3.18.
  We begin by defining the maps that will become our smooth charts.
  Given any smooth (possibly boundary) chart $(U, \phi)$ for $M$, note that $\pi^{-1}(U) \subset TM$ is the set of all tangent vectors to $M$ at all points of $U$.
  Let $(x^1, \cdots, x^n)$ denote the coordinate functions of $\phi$, and define a map $\tilde{\phi}$ that maps $\pi^{-1}(U)$ into $\mathbb{H}^{2n}$ or $\mathbb{R}^{2n}$ by
  \begin{align*}
    \tilde{\phi}(v^i\frac{\partial}{\partial x^i}\Big\vert_p) = (v^1, \cdots, v^n, x^1(p), \cdots, x^n(p)).
  \end{align*}
  In case $(U, \phi)$ is a boundary chart, $\tilde(\phi)$ indeed maps $\pi^{-1}(U)$ into $\mathbb{H}^{2n}$ because $x^n(p) \geq 0$.
  Its image set is $\mathbb{R}^n \times \phi(U)$, which is an open subset of $\mathbb{R}^{2n}$ or $\mathbb{H}^{2n}$.
  Now suppose we are given two smooth charts $(U, \phi)$ and $(V, \psi)$ for $M$, and let $(\pi^{-1}(U), \tilde{\phi}), (\pi^{-1}(V), \tilde{\psi})$ be the corresponding charts on $TM$. The sets
  \begin{align*}
    \tilde{\phi}(\pi^{-1}(U) \cap \pi^{-1}(V)) &= \mathbb{R}^n \times \phi(U \cap V) & \text{and}\\
    \tilde{\psi}(\pi^{-1}(U) \cap \pi^{-1}(V)) &= \mathbb{R}^n \times \psi(U \cap V)
  \end{align*}
  are open in $\mathbb{R}^{2n}$ or $\mathbb{H}^{2n}$, and the transition map $\tilde{\psi} \circ \tilde{\phi}$ can be written explicitly using (\ref{remark_3_12}) as
  \begin{align*}
    &(\tilde{\psi} \circ \tilde{\phi}^{-1})(x^1, \cdots, x^n, v^1, \cdots, v^n) \\
      &= (\frac{\partial \tilde{x}^1}{\partial x^j}(x)v^j, \cdots, \frac{\partial \tilde{x}^n}{\partial x^j}(x)v^j, \tilde{x}^1(x), \cdots, \tilde{x}^n(x)).
  \end{align*}
  The rest of the proof is identical to that of Proposition 3.18.
\end{proof}

\begin{customthm}{3.21}
  If $F: M \rightarrow N$ is a smooth map, then its global differential $dF: TM \rightarrow TN$ is a smooth map.
\end{customthm}

\begin{proof}
  Let $(p_0, v_0) \in TM$ be given.
  It suffices to show that $F$ is smooth in an neighborhood around $(p_0, v_0)$.
  Let $(U, \phi), (V, \psi)$ be given such that $p_0 \in U, F(U) \subset V$ and $F(p_0) \in V$.
  The set $\pi^{-1}(U)$ is open in $TM$ because that is how we give $TM$ a topology in Proposition 3.18.
  Moreover, $\pi^{-1}(U)$ is a neighborhood of $(p_0, v_0)$ in $TM$.
  We will consider the charts $(\pi^{-1}, \tilde{\phi})$ and $(\pi^{-1}(V), \tilde{\psi})$ as defined in Proposition 3.18.
  Let $(x^1, \cdots, x^m, v^1, \cdots, v^m) \in \tilde{\phi}(\pi^{-1}(U))$.
  Let $x = (x^1, \cdots, x^m)$ and $p = \phi^{-1}(x)$.
  Then 
  \begin{align*}
    dF_{p}(\frac{\partial}{\partial x^i}\Big\vert_{p}) = \frac{\partial F^j}{\partial x^i}(p)\frac{\partial}{\partial y^j}\Big\vert_{F(p)}
  \end{align*}
  by (3.9) in the textbook.
  Then 
  \begin{align*}
    (\tilde{\psi} \circ dF \circ \tilde{\phi}^{-1})(x^1, \cdots, x^m, v^1, \cdots, v^m)
      &= ((\psi^1 \circ F \circ \phi^{-1})(x), \cdots, (\psi^n \circ F \circ \phi^{-1})(x), \frac{\partial F^1}{\partial x^i}(p)v^i, \cdots, \frac{\partial F^n}{\partial x^i}(p)v^i)
  \end{align*}

  Since each component function is smooth, $\tilde{\psi} \circ dF \circ \tilde{\phi}^{-1}$ is smooth.
  Therefore, $dF$ is a smooth map from $TM$ to $TN$.
\end{proof}

\begin{customthm}{3.23}
  Suppose $M$ is a smooth manifold with or without boundary and $p \in M$.
  Every $v \in T_pM$ is the velocity of some smooth curve in $M$.
\end{customthm}

\begin{proof}
  First, suppose that $p \in \Int M$.
  Let $(U, \phi)$ be a smooth coordinate chart centered at $p$, and write $v = v^i \partial / \partial x^i\vert_p$ in terms of the coordinate basis.
  Without loss of generality, $\phi(p) = 0 \in \mathbb{R}^n$.
  Now, define $\hat{\gamma}: (-\epsilon, \epsilon) \rightarrow \hat{U}$ by $\hat{\gamma}(t) = (tv_1, \cdots, tv_n)$ for sufficiently small $\epsilon > 0$.
  Let $\gamma: (-\epsilon, \epsilon) \rightarrow U$ be defined by $\gamma = \phi^{-1} \circ \hat{\gamma}$.
  Then $\gamma$ is actually a smooth map from a 1-manifold $(-\epsilon, \epsilon)$ to an $n$-manifold $M$ (with or without boundary).
  We will use the formula derived in (\ref{jacobian_differentials}) and obtain
  \begin{align*}
    \gamma'(0)
      &= d\gamma(\frac{d}{dt}\Big\vert_{0}) \\
      &= \sum_{j=1}^{n}\frac{\partial\hat{\gamma}^j}{\partial t}(0)\frac{\partial}{\partial x^j}\Big\vert_{p} \\
      &= \sum_{j=1}^{n}v^j\frac{\partial}{\partial x^j}\Big\vert_{p} \\
      &= v.
  \end{align*}

  If $p \in \partial M$, then we do the exact same thing as above except that the domain will be $[0, \epsilon)$ if $v_n > 0$ and $(-\epsilon, 0]$ if $v_n \leq 0$.
\end{proof}

\subsection{Problems}

\begin{customprob}{3-1}
  Suppose $M$ and $N$ are smooth manifolds with or without boundary, and $F: M \rightarrow N$ is a smooth map.
  Show that $dF_p: T_pM \rightarrow T_{F(p)}N$ is the zero map for each $p \in M$ if and only if $F$ is constant on each component of $M$.
\end{customprob}

\begin{proof}
  Suppose $dF_p: T_pM \rightarrow T_{F(p)}N$ is the zero map for each $p \in M$.
  It suffices to show that for every $p \in M$, there exists a neighborhood of $p$ on which $F$ is constant.
  Let $p \in M$ and $(U, \phi) \in \mathcal{A}_M, (V, \psi) \in \mathcal{A}_N$ be given such that $p \in U$ and $F(U) \subset V$.
  Without loss of generality, we assume $\hat{U} = \phi(U)$ is an open ball in $\mathbb{R}^m$.
  Then for any $i, j$ and for any $q \in \hat{U}$,
  \begin{align*}
    dF_q(\frac{\partial}{\partial x^i}\vert_q)(\pi_j \circ \psi) = 0
      &\implies (\frac{\partial}{\partial x^i}\vert_q)(\pi_j \circ \psi \circ F) = 0 \\
      &\implies (\frac{\partial}{\partial x^i}\vert_{\phi(q)})(\pi_j \circ \psi \circ F \circ \phi^{-1}) = 0.
  \end{align*}
  Fix $j$.
  Then every partial derivative of $\pi_j \circ \psi \circ F \circ \phi^{-1}$ at every point in $\hat{U}$ is 0.
  The intermediate value theorem implies that $\pi_j \circ \psi \circ F \circ \phi^{-1}$ is constant on $\hat{U}$ because $\hat{U}$ is an open ball.
  In other words, $(\pi_j \circ \psi \circ F \circ \phi^{-1})(\hat{U}) = \{ y_j \}$ for some $y_j \in \mathbb{R}$.
  Since this is true for every $j$ and $\pi_j$ is the projection of the $j$th coordinate, $(\psi \circ F \circ \phi^{-1})(\hat{U}) = \{ y \}$ where $y = (y_1, \cdots, y_n)$.
  Then $(F \circ \phi^{-1})(\hat{U}) = F(U) = \psi^{-1}(y)$.
  Since $\psi$ is a homeomorphism, there exists exactly one point in $\psi^{-1}(U)$.
  In other words, $F$ is constant on $U$.
  Therefore, $F$ is constant on each path component.

  Suppose $F$ is constant on each component of $M$.
  Let $p \in M$.
  Choose a chart $(U, \phi) \in \mathcal{A}_M$ such that $p \in U$.
  Then $F \circ \phi^{-1}$ is constant in a neighborhood around $\phi(p)$.
  For any $i$,
  \begin{align*}
    dF_p(\frac{\partial}{\partial x^i}\vert_p)(f)
      &= \frac{\partial}{\partial x^i}\vert_p(f \circ F) \\
      &= \frac{\partial}{\partial x^i}\vert_{\phi(p)}(f \circ F \circ \phi^{-1}) \\
      &= 0
  \end{align*}
  because $f \circ F \circ \phi^{-1}$ is constant in a neighborhood around $\phi(p)$.
  By Proposition 3.15, $\partial / \partial x^i\vert_p$ form a basis for $T_pM$.
  Since $dF_p$ sends each basis element to 0, $dF_p = 0$.
\end{proof}

\begin{customprob}{3-2(Proof of Proposition 3.14)}\label{problem_3_2}
  Let $M_1, \cdots, M_k$ be smooth manifolds, and for each $j$, let $\pi_j: M_1 \times \cdots \times M_k \rightarrow M_j$ be the projection onto the $M_j$ factor.
  For any point $p = (p_1, \cdots, p_k) \in M_1 \times \cdots \times M_k$, the map
  \begin{align*}
    \alpha: T_p(M_1 \times \cdots \times M_k) \rightarrow T_{p_1}M_1 \oplus \cdots \oplus T_{p_k}M_k
  \end{align*}
  defined by
  \begin{align*}
    \alpha(v) = (d(\pi_1)_p(v), \cdots, d(\pi_k)_p(v))
  \end{align*}
  is an isomorphism.
  The same is true if one of the spaces $M_i$ is a smooth manifold with boundary.
\end{customprob}

\begin{proof}
  It suffices to show this for the case that $k = 2$ because the results extend to arbitrary $k$ by induction.
  Let $\mathcal{A}_{M_1}, \mathcal{A}_{M_2}, \mathcal{A}_{M_1 \times M_2}$ be the smooth structures of $M_1, M_2, M_1 \times M_2$.

  We first define a lot of notations.
  \begin{itemize}
    \item
      Let $d_1, d_2$ denote the dimensions of $M_1, M_2$ and let $d = d_1 + d_2$ denote the dimension of $M_1 \times M_2$.
    \item
      Let $p = (p_1, p_2) \in M_1 \times M_2$ be given.
      Choose $(U, \phi = (x^i)) \in \mathcal{A}_{M_1}, (V, \psi = (y^i)) \in \mathcal{A}_{M_2}$ with $p_1 \in U$ and $p_2 \in V$.
      Let $q_1 = \phi(p_1), q_2 = \psi(p_2), q = q_1 \times q_2$.
    \item
      $(U \times V, (z^i)) \in \mathcal{A}_{M_1 \times M_2}$ and $(p_1, p_2) \in U \times V$ where $(z^i) = \phi \times \psi$.
      More specifically, $z^i = x^i \circ \pi_1$ for $1 \leq i \leq d_1$ and $z^i = y^i \circ \pi_2$ for $d_1 + 1 \leq i \leq d_1 + d_2$.
  \end{itemize}
  Note that we use $x^i, y^i, z^i, \pi_1$ to mean two different things in this solution: 
  \begin{itemize}
    \item
      $x^i$ is either the $i$th coordinate function of $\phi$ or the $i$th projection map $\mathbb{R}^{d_1} \rightarrow \mathbb{R}$.
    \item
      $y^i$ is either the $i$th coordinate function of $\psi$ or the $i$th projection map $\mathbb{R}^{d_2} \rightarrow \mathbb{R}$.
    \item
      $z^i$ is either the $i$th coordinate function of $\phi \times \psi$ or the $i$th projection map $\mathbb{R}^{d_1 + d_2} \rightarrow \mathbb{R}$.
    \item
      $\pi_1$ is either the projection map $M_1 \times M_2 \rightarrow M_1$ or the projection map $\mathbb{R}^{d_1 + d_2} \rightarrow \mathbb{R}^{d_1}$.
    \item
      $\pi_2$ is either the projection map $M_1 \times M_2 \rightarrow M_2$ or the projection map $\mathbb{R}^{d_1 + d_2} \rightarrow \mathbb{R}^{d_2}$.
  \end{itemize}

  By Proposition 3.15, $\{ \partial / \partial x^1 \vert_{p_1}, \cdots, \partial / \partial x^{d_1} \vert_{p_1} \}, \{ \partial / \partial y^1 \vert_{p_2}, \cdots, \partial / \partial y^{d_2} \vert_{p_2} \}, \{ \partial / \partial z^1 \vert_{p}, \cdots, \partial / \partial z^{d_1 + d_2} \vert_{p} \}$ form bases for $T_{p_1}M_1, T_{p_2}M_2, T_p(M_1 \times M_2)$.

  $\alpha(\partial / \partial z^1 \vert_p) = (d(\pi_1)_p(\partial/\partial z^1\vert_p), d(\pi_2)_p(\partial/\partial z^1\vert_p))$.
  We claim that $d(\pi_1)_p(\partial / \partial z^1 \vert_p) = \partial / \partial x^1 \vert p_1$.

  \begin{align*}
    d(\pi_1)_p(\partial / \partial z^1 \vert_p)(f)
      &= d(\pi_1)_p(d(\phi^{-1} \times \psi^{-1})_q)(\frac{\partial}{\partial z^1}\vert_q) (f)\\
      &= (d(\pi_1)_p \circ d(\phi^{-1} \times \psi^{-1})_q)(\frac{\partial}{\partial z^1}\vert_q) (f)\\
      &= d(\pi_1 \circ (\phi^{-1} \times \psi^{-1})_q)(\frac{\partial}{\partial z^1}\vert_q) (f)\\
      &= \lim_{h \rightarrow 0} \frac{(f \circ \pi_1 \circ (\phi^{-1} \times \psi^{-1}))(q + e_1h) - (f \circ \pi_1 \circ (\phi^{-1} \times \psi^{-1}))(q)}{h} \\
      &= \lim_{h \rightarrow 0} \frac{(f \circ \pi_1)(\phi^{-1}(q_1 + e_1h), p_2) - (f \circ \pi_1)(p)}{h} \\
      &= \lim_{h \rightarrow 0} \frac{f(\phi^{-1}(q_1 + e_1h)) - f(p_1)}{h} \\
      &= \lim_{h \rightarrow 0} \frac{f(\phi^{-1}(q_1 + e_1h)) - f(\phi^{-1}(q_1))}{h} \\
      &= (\frac{\partial}{\partial x^1}\vert_{q_1})(f \circ \phi^{-1}) \\
      &= d(\phi^{-1})_{q_1}(\frac{\partial}{\partial x^1}\vert_{q_1})(f) \\
      &= (\frac{\partial}{\partial x^1}\vert_{p_1})(f).
  \end{align*}

  The same result can be shown for the other combinations of $\pi_1, \pi_2$ and $z^1, \cdots, z^{d_1 + d_2}$.
  For any $c_1, \cdots, c_{d_1 + d_2} \in \mathbb{R}$,
  \begin{align*}
    \alpha(\sum_{i=1}^{d_1 + d_2} c_{i}\frac{\partial}{\partial z^{i}}\vert_p)
      &= \sum_{i=1}^{d_1 + d_2} c_i\alpha(\frac{\partial}{\partial z^{i}}\vert_p) \\
      &= \sum_{i=1}^{d_1 + d_2} c_i(d(\pi_1)_p\frac{\partial}{\partial z^{i}}\vert_p, d(\pi_2)_p\frac{\partial}{\partial z^i}\vert_p) \\
      &= \sum_{i=1}^{d_1} c_i(d(\pi_1)_p\frac{\partial}{\partial z^{i}}\vert_p, d(\pi_2)_p\frac{\partial}{\partial z^i}\vert_p) 
         + \sum_{i=d_1 + 1}^{d_2} c_i(d(\pi_1)_p\frac{\partial}{\partial z^{i}}\vert_p, d(\pi_2)_p\frac{\partial}{\partial z^i}\vert_p) \\
      &= \sum_{i=1}^{d_1} c_i(\frac{\partial}{\partial x^i} \vert_{p_1}, 0)
         + \sum_{i=1}^{d_2} c_{d_1 + i}(0, \frac{\partial}{\partial y^i} \vert_{p_2}) \\
      &= (c_1\frac{\partial}{\partial x^1}\vert_{p_1} + \cdots + c_{d_1}\frac{\partial}{\partial x^{d_1}}\vert_{p_1},
          c_{d_1 + 1}\frac{\partial}{\partial y^{1}}\vert_{p_2} + \cdots + c_{d_1 + d_2}\frac{\partial}{\partial y^{d_2}}\vert_{p_2}).
  \end{align*}

  Therefore, $\alpha$ is bijective.
\end{proof}

\begin{customprob}{3-3}
  Prove that if $M$ and $N$ are smooth manifolds, then $T(M \times N)$ is diffeomorphic to $TM \times TN$.
\end{customprob}

\begin{proof}
  Let $\pi_1: M \times N \rightarrow M$ and $\pi_2: M \times N \rightarrow N$ be the obvious projections of the corresponding coordinates.
  $\pi_1, \pi_2$ are clearly smooth, so Proposition 3.21 shows that $d\pi_1: T(M \times N) \rightarrow TM$ and $d\pi_2: T(M \times N) \rightarrow TN$ are both smooth.
  By (\ref{exercise_2_16}(b)), $d\pi_1 \times d\pi_2$ is a smooth map.

  By (\ref{problem_3_2}), $d\pi_1 \times d\pi_2$ is a bijection between $T_{(p, q)}(M \times N)$ and $T_p(M) \times T_q(N)$.
  Since $d\pi_1 \times d\pi_2$ sends $((p, q), \sigma)$ to $(p, d\pi_1(\sigma)) \times (q, d\pi_2(\sigma))$, we conclude that $d\pi_1 \times d\pi_2$ is bijective.
\end{proof}
